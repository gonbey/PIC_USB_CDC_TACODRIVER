/******************************************************************************
 Software License Agreement:

 The software supplied herewith by Microchip Technology Incorporated
 (the "Company") for its PICmicro(r) Microcontroller is intended and
 supplied to you, the Company's customer, for use solely and
 exclusively on Microchip PICmicro Microcontroller products. The
 software is owned by the Company and/or its supplier, and is
 protected under applicable copyright laws. All rights are reserved.
 Any use in violation of the foregoing restrictions may subject the
 user to criminal sanctions under applicable laws, as well as to
 civil liability for the breach of the terms and conditions of this
 license.

 THIS SOFTWARE IS PROVIDED IN AN "AS IS" CONDITION. NO WARRANTIES,
 WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED
 TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
 PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,
 IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR
 CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.
********************************************************************/
 
#include <string.h>
#include <stdint.h>
#include "crypto_sw/crypto_sw.h"

/****************************************************************************/
/* Test keys and results                                                    */
/****************************************************************************/

const uint8_t key40BitInc[5] = {0x01,0x02,0x03,0x04,0x05};
const uint8_t result40BitInc[16][16] = {
                                        {0xb2,0x39,0x63,0x05,0xf0,0x3d,0xc0,0x27,0xcc,0xc3,0x52,0x4a,0x0a,0x11,0x18,0xa8,},
                                        {0x69,0x82,0x94,0x4f,0x18,0xfc,0x82,0xd5,0x89,0xc4,0x03,0xa4,0x7a,0x0d,0x09,0x19,},
                                        {0x28,0xcb,0x11,0x32,0xc9,0x6c,0xe2,0x86,0x42,0x1d,0xca,0xad,0xb8,0xb6,0x9e,0xae,},
                                        {0x1c,0xfc,0xf6,0x2b,0x03,0xed,0xdb,0x64,0x1d,0x77,0xdf,0xcf,0x7f,0x8d,0x8c,0x93,},
                                        {0x42,0xb7,0xd0,0xcd,0xd9,0x18,0xa8,0xa3,0x3d,0xd5,0x17,0x81,0xc8,0x1f,0x40,0x41,},
                                        {0x64,0x59,0x84,0x44,0x32,0xa7,0xda,0x92,0x3c,0xfb,0x3e,0xb4,0x98,0x06,0x61,0xf6,},
                                        {0xec,0x10,0x32,0x7b,0xde,0x2b,0xee,0xfd,0x18,0xf9,0x27,0x76,0x80,0x45,0x7e,0x22,},
                                        {0xeb,0x62,0x63,0x8d,0x4f,0x0b,0xa1,0xfe,0x9f,0xca,0x20,0xe0,0x5b,0xf8,0xff,0x2b,},
                                        {0x45,0x12,0x90,0x48,0xe6,0xa0,0xed,0x0b,0x56,0xb4,0x90,0x33,0x8f,0x07,0x8d,0xa5,},
                                        {0x30,0xab,0xbc,0xc7,0xc2,0x0b,0x01,0x60,0x9f,0x23,0xee,0x2d,0x5f,0x6b,0xb7,0xdf,},
                                        {0x32,0x94,0xf7,0x44,0xd8,0xf9,0x79,0x05,0x07,0xe7,0x0f,0x62,0xe5,0xbb,0xce,0xea,},
                                        {0xd8,0x72,0x9d,0xb4,0x18,0x82,0x25,0x9b,0xee,0x4f,0x82,0x53,0x25,0xf5,0xa1,0x30,},
                                        {0x1e,0xb1,0x4a,0x0c,0x13,0xb3,0xbf,0x47,0xfa,0x2a,0x0b,0xa9,0x3a,0xd4,0x5b,0x8b,},
                                        {0xcc,0x58,0x2f,0x8b,0xa9,0xf2,0x65,0xe2,0xb1,0xbe,0x91,0x12,0xe9,0x75,0xd2,0xd7,},
                                        {0xf2,0xe3,0x0f,0x9b,0xd1,0x02,0xec,0xbf,0x75,0xaa,0xad,0xe9,0xbc,0x35,0xc4,0x3c,},
                                        {0xec,0x0e,0x11,0xc4,0x79,0xdc,0x32,0x9d,0xc8,0xda,0x79,0x68,0xfe,0x96,0x56,0x81,},
};

const uint8_t key56BitInc[7] = {0x01,0x02,0x03,0x04,0x05,0x06,0x07};
const uint8_t result56BitInc[16][16] = {
                                        {0x29,0x3f,0x02,0xd4,0x7f,0x37,0xc9,0xb6,0x33,0xf2,0xaf,0x52,0x85,0xfe,0xb4,0x6b,},
                                        {0xe6,0x20,0xf1,0x39,0x0d,0x19,0xbd,0x84,0xe2,0xe0,0xfd,0x75,0x20,0x31,0xaf,0xc1,},
                                        {0x91,0x4f,0x02,0x53,0x1c,0x92,0x18,0x81,0x0d,0xf6,0x0f,0x67,0xe3,0x38,0x15,0x4c,},
                                        {0xd0,0xfd,0xb5,0x83,0x07,0x3c,0xe8,0x5a,0xb8,0x39,0x17,0x74,0x0e,0xc0,0x11,0xd5,},
                                        {0x75,0xf8,0x14,0x11,0xe8,0x71,0xcf,0xfa,0x70,0xb9,0x0c,0x74,0xc5,0x92,0xe4,0x54,},
                                        {0x0b,0xb8,0x72,0x02,0x93,0x8d,0xad,0x60,0x9e,0x87,0xa5,0xa1,0xb0,0x79,0xe5,0xe4,},
                                        {0xc2,0x91,0x12,0x46,0xb6,0x12,0xe7,0xe7,0xb9,0x03,0xdf,0xed,0xa1,0xda,0xd8,0x66,},
                                        {0x32,0x82,0x8f,0x91,0x50,0x2b,0x62,0x91,0x36,0x8d,0xe8,0x08,0x1d,0xe3,0x6f,0xc2,},
                                        {0xf3,0xb9,0xa7,0xe3,0xb2,0x97,0xbf,0x9a,0xd8,0x04,0x51,0x2f,0x90,0x63,0xef,0xf1,},
                                        {0x8e,0xcb,0x67,0xa9,0xba,0x1f,0x55,0xa5,0xa0,0x67,0xe2,0xb0,0x26,0xa3,0x67,0x6f,},
                                        {0xd2,0xaa,0x90,0x2b,0xd4,0x2d,0x0d,0x7c,0xfd,0x34,0x0c,0xd4,0x58,0x10,0x52,0x9f,},
                                        {0x78,0xb2,0x72,0xc9,0x6e,0x42,0xea,0xb4,0xc6,0x0b,0xd9,0x14,0xe3,0x9d,0x06,0xe3,},
                                        {0xf4,0x33,0x2f,0xd3,0x1a,0x07,0x93,0x96,0xee,0x3c,0xee,0x3f,0x2a,0x4f,0xf0,0x49,},
                                        {0x05,0x45,0x97,0x81,0xd4,0x1f,0xda,0x7f,0x30,0xc1,0xbe,0x7e,0x12,0x46,0xc6,0x23,},
                                        {0xad,0xfd,0x38,0x68,0xb8,0xe5,0x14,0x85,0xd5,0xe6,0x10,0x01,0x7e,0x3d,0xd6,0x09,},
                                        {0xad,0x26,0x58,0x1c,0x0c,0x5b,0xe4,0x5f,0x4c,0xea,0x01,0xdb,0x2f,0x38,0x05,0xd5,},
};

const uint8_t key64BitInc[8] = {0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08};
const uint8_t result64BitInc[16][16] = {
                                        {0x97,0xab,0x8a,0x1b,0xf0,0xaf,0xb9,0x61,0x32,0xf2,0xf6,0x72,0x58,0xda,0x15,0xa8,},
                                        {0x82,0x63,0xef,0xdb,0x45,0xc4,0xa1,0x86,0x84,0xef,0x87,0xe6,0xb1,0x9e,0x5b,0x09,},
                                        {0x96,0x36,0xeb,0xc9,0x84,0x19,0x26,0xf4,0xf7,0xd1,0xf3,0x62,0xbd,0xdf,0x6e,0x18,},
                                        {0xd0,0xa9,0x90,0xff,0x2c,0x05,0xfe,0xf5,0xb9,0x03,0x73,0xc9,0xff,0x4b,0x87,0x0a,},
                                        {0x73,0x23,0x9f,0x1d,0xb7,0xf4,0x1d,0x80,0xb6,0x43,0xc0,0xc5,0x25,0x18,0xec,0x63,},
                                        {0x16,0x3b,0x31,0x99,0x23,0xa6,0xbd,0xb4,0x52,0x7c,0x62,0x61,0x26,0x70,0x3c,0x0f,},
                                        {0x49,0xd6,0xc8,0xaf,0x0f,0x97,0x14,0x4a,0x87,0xdf,0x21,0xd9,0x14,0x72,0xf9,0x66,},
                                        {0x44,0x17,0x3a,0x10,0x3b,0x66,0x16,0xc5,0xd5,0xad,0x1c,0xee,0x40,0xc8,0x63,0xd0,},
                                        {0x27,0x3c,0x9c,0x4b,0x27,0xf3,0x22,0xe4,0xe7,0x16,0xef,0x53,0xa4,0x7d,0xe7,0xa4,},
                                        {0xc6,0xd0,0xe7,0xb2,0x26,0x25,0x9f,0xa9,0x02,0x34,0x90,0xb2,0x61,0x67,0xad,0x1d,},
                                        {0x1f,0xe8,0x98,0x67,0x13,0xf0,0x7c,0x3d,0x9a,0xe1,0xc1,0x63,0xff,0x8c,0xf9,0xd3,},
                                        {0x83,0x69,0xe1,0xa9,0x65,0x61,0x0b,0xe8,0x87,0xfb,0xd0,0xc7,0x91,0x62,0xaa,0xfb,},
                                        {0x0a,0x01,0x27,0xab,0xb4,0x44,0x84,0xb9,0xfb,0xef,0x5a,0xbc,0xae,0x1b,0x57,0x9f,},
                                        {0xc2,0xcd,0xad,0xc6,0x40,0x2e,0x8e,0xe8,0x66,0xe1,0xf3,0x7b,0xdb,0x47,0xe4,0x2c,},
                                        {0x26,0xb5,0x1e,0xa3,0x7d,0xf8,0xe1,0xd6,0xf7,0x6f,0xc3,0xb6,0x6a,0x74,0x29,0xb3,},
                                        {0xbc,0x76,0x83,0x20,0x5d,0x4f,0x44,0x3d,0xc1,0xf2,0x9d,0xda,0x33,0x15,0xc8,0x7b,},
};

const uint8_t key80BitInc[10] = {0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A};
const uint8_t result80BitInc[16][16] = {
                                        {0xed,0xe3,0xb0,0x46,0x43,0xe5,0x86,0xcc,0x90,0x7d,0xc2,0x18,0x51,0x70,0x99,0x02,},
                                        {0x03,0x51,0x6b,0xa7,0x8f,0x41,0x3b,0xeb,0x22,0x3a,0xa5,0xd4,0xd2,0xdf,0x67,0x11,},
                                        {0x3c,0xfd,0x6c,0xb5,0x8e,0xe0,0xfd,0xde,0x64,0x01,0x76,0xad,0x00,0x00,0x04,0x4d,},
                                        {0x48,0x53,0x2b,0x21,0xfb,0x60,0x79,0xc9,0x11,0x4c,0x0f,0xfd,0x9c,0x04,0xa1,0xad,},
                                        {0x3e,0x8c,0xea,0x98,0x01,0x71,0x09,0x97,0x90,0x84,0xb1,0xef,0x92,0xf9,0x9d,0x86,},
                                        {0xe2,0x0f,0xb4,0x9b,0xdb,0x33,0x7e,0xe4,0x8b,0x8d,0x8d,0xc0,0xf4,0xaf,0xef,0xfe,},
                                        {0x5c,0x25,0x21,0xea,0xcd,0x79,0x66,0xf1,0x5e,0x05,0x65,0x44,0xbe,0xa0,0xd3,0x15,},
                                        {0xe0,0x67,0xa7,0x03,0x19,0x31,0xa2,0x46,0xa6,0xc3,0x87,0x5d,0x2f,0x67,0x8a,0xcb,},
                                        {0xa6,0x4f,0x70,0xaf,0x88,0xae,0x56,0xb6,0xf8,0x75,0x81,0xc0,0xe2,0x3e,0x6b,0x08,},
                                        {0xf4,0x49,0x03,0x1d,0xe3,0x12,0x81,0x4e,0xc6,0xf3,0x19,0x29,0x1f,0x4a,0x05,0x16,},
                                        {0xbd,0xae,0x85,0x92,0x4b,0x3c,0xb1,0xd0,0xa2,0xe3,0x3a,0x30,0xc6,0xd7,0x95,0x99,},
                                        {0x8a,0x0f,0xed,0xdb,0xac,0x86,0x5a,0x09,0xbc,0xd1,0x27,0xfb,0x56,0x2e,0xd6,0x0a,},
                                        {0xb5,0x5a,0x0a,0x5b,0x51,0xa1,0x2a,0x8b,0xe3,0x48,0x99,0xc3,0xe0,0x47,0x51,0x1a,},
                                        {0xd9,0xa0,0x9c,0xea,0x3c,0xe7,0x5f,0xe3,0x96,0x98,0x07,0x03,0x17,0xa7,0x13,0x39,},
                                        {0x55,0x22,0x25,0xed,0x11,0x77,0xf4,0x45,0x84,0xac,0x8c,0xfa,0x6c,0x4e,0xb5,0xfc,},
                                        {0x7e,0x82,0xcb,0xab,0xfc,0x95,0x38,0x1b,0x08,0x09,0x98,0x44,0x21,0x29,0xc2,0xf8,},
};

const uint8_t key128BitInc[16] = {0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x10};
const uint8_t result128BitInc[16][16] = {
                                        {0x9a,0xc7,0xcc,0x9a,0x60,0x9d,0x1e,0xf7,0xb2,0x93,0x28,0x99,0xcd,0xe4,0x1b,0x97,},
                                        {0x52,0x48,0xc4,0x95,0x90,0x14,0x12,0x6a,0x6e,0x8a,0x84,0xf1,0x1d,0x1a,0x9e,0x1c,},
                                        {0x06,0x59,0x02,0xe4,0xb6,0x20,0xf6,0xcc,0x36,0xc8,0x58,0x9f,0x66,0x43,0x2f,0x2b,},
                                        {0xd3,0x9d,0x56,0x6b,0xc6,0xbc,0xe3,0x01,0x07,0x68,0x15,0x15,0x49,0xf3,0x87,0x3f,},
                                        {0xb6,0xd1,0xe6,0xc4,0xa5,0xe4,0x77,0x1c,0xad,0x79,0x53,0x8d,0xf2,0x95,0xfb,0x11,},
                                        {0xc6,0x8c,0x1d,0x5c,0x55,0x9a,0x97,0x41,0x23,0xdf,0x1d,0xbc,0x52,0xa4,0x3b,0x89,},
                                        {0xc5,0xec,0xf8,0x8d,0xe8,0x97,0xfd,0x57,0xfe,0xd3,0x01,0x70,0x1b,0x82,0xa2,0x59,},
                                        {0xec,0xcb,0xe1,0x3d,0xe1,0xfc,0xc9,0x1c,0x11,0xa0,0xb2,0x6c,0x0b,0xc8,0xfa,0x4d,},
                                        {0xe7,0xa7,0x25,0x74,0xf8,0x78,0x2a,0xe2,0x6a,0xab,0xcf,0x9e,0xbc,0xd6,0x60,0x65,},
                                        {0xbd,0xf0,0x32,0x4e,0x60,0x83,0xdc,0xc6,0xd3,0xce,0xdd,0x3c,0xa8,0xc5,0x3c,0x16,},
                                        {0xb4,0x01,0x10,0xc4,0x19,0x0b,0x56,0x22,0xa9,0x61,0x16,0xb0,0x01,0x7e,0xd2,0x97,},
                                        {0xff,0xa0,0xb5,0x14,0x64,0x7e,0xc0,0x4f,0x63,0x06,0xb8,0x92,0xae,0x66,0x11,0x81,},
                                        {0xd0,0x3d,0x1b,0xc0,0x3c,0xd3,0x3d,0x70,0xdf,0xf9,0xfa,0x5d,0x71,0x96,0x3e,0xbd,},
                                        {0x8a,0x44,0x12,0x64,0x11,0xea,0xa7,0x8b,0xd5,0x1e,0x8d,0x87,0xa8,0x87,0x9b,0xf5,},
                                        {0xfa,0xbe,0xb7,0x60,0x28,0xad,0xe2,0xd0,0xe4,0x87,0x22,0xe4,0x6c,0x46,0x15,0xa3,},
                                        {0xc0,0x5d,0x88,0xab,0xd5,0x03,0x57,0xf9,0x35,0xa6,0x3c,0x59,0xee,0x53,0x76,0x23,},
};

const uint8_t key192BitInc[24] = {0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18};
const uint8_t result192BitInc[16][16] = {
                                        {0x05,0x95,0xe5,0x7f,0xe5,0xf0,0xbb,0x3c,0x70,0x6e,0xda,0xc8,0xa4,0xb2,0xdb,0x11,},
                                        {0xdf,0xde,0x31,0x34,0x4a,0x1a,0xf7,0x69,0xc7,0x4f,0x07,0x0a,0xee,0x9e,0x23,0x26,},
                                        {0xb0,0x6b,0x9b,0x1e,0x19,0x5d,0x13,0xd8,0xf4,0xa7,0x99,0x5c,0x45,0x53,0xac,0x05,},
                                        {0x6b,0xd2,0x37,0x8e,0xc3,0x41,0xc9,0xa4,0x2f,0x37,0xba,0x79,0xf8,0x8a,0x32,0xff,},
                                        {0xe7,0x0b,0xce,0x1d,0xf7,0x64,0x5a,0xdb,0x5d,0x2c,0x41,0x30,0x21,0x5c,0x35,0x22,},
                                        {0x9a,0x57,0x30,0xc7,0xfc,0xb4,0xc9,0xaf,0x51,0xff,0xda,0x89,0xc7,0xf1,0xad,0x22,},
                                        {0x04,0x85,0x05,0x5f,0xd4,0xf6,0xf0,0xd9,0x63,0xef,0x5a,0xb9,0xa5,0x47,0x69,0x82,},
                                        {0x59,0x1f,0xc6,0x6b,0xcd,0xa1,0x0e,0x45,0x2b,0x03,0xd4,0x55,0x1f,0x6b,0x62,0xac,},
                                        {0x27,0x53,0xcc,0x83,0x98,0x8a,0xfa,0x3e,0x16,0x88,0xa1,0xd3,0xb4,0x2c,0x9a,0x02,},
                                        {0x93,0x61,0x0d,0x52,0x3d,0x1d,0x3f,0x00,0x62,0xb3,0xc2,0xa3,0xbb,0xc7,0xc7,0xf0,},
                                        {0x96,0xc2,0x48,0x61,0x0a,0xad,0xed,0xfe,0xaf,0x89,0x78,0xc0,0x3d,0xe8,0x20,0x5a,},
                                        {0x0e,0x31,0x7b,0x3d,0x1c,0x73,0xb9,0xe9,0xa4,0x68,0x8f,0x29,0x6d,0x13,0x3a,0x19,},
                                        {0xbd,0xf0,0xe6,0xc3,0xcc,0xa5,0xb5,0xb9,0xd5,0x33,0xb6,0x9c,0x56,0xad,0xa1,0x20,},
                                        {0x88,0xa2,0x18,0xb6,0xe2,0xec,0xe1,0xe6,0x24,0x6d,0x44,0xc7,0x59,0xd1,0x9b,0x10,},
                                        {0x68,0x66,0x39,0x7e,0x95,0xc1,0x40,0x53,0x4f,0x94,0x26,0x34,0x21,0x00,0x6e,0x40,},
                                        {0x32,0xcb,0x0a,0x1e,0x95,0x42,0xc6,0xb3,0xb8,0xb3,0x98,0xab,0xc3,0xb0,0xf1,0xd5,},
};

const uint8_t key256BitInc[32] = {0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1A,0x1B,0x1C,0x1D,0x1E,0x1F,0x20};
const uint8_t result256BitInc[16][16] = {
                                        {0xea,0xa6,0xbd,0x25,0x88,0x0b,0xf9,0x3d,0x3f,0x5d,0x1e,0x4c,0xa2,0x61,0x1d,0x91,},
                                        {0xcf,0xa4,0x5c,0x9f,0x7e,0x71,0x4b,0x54,0xbd,0xfa,0x80,0x02,0x7c,0xb1,0x43,0x80,},
                                        {0x11,0x4a,0xe3,0x44,0xde,0xd7,0x1b,0x35,0xf2,0xe6,0x0f,0xeb,0xad,0x72,0x7f,0xd8,},
                                        {0x02,0xe1,0xe7,0x05,0x6b,0x0f,0x62,0x39,0x00,0x49,0x64,0x22,0x94,0x3e,0x97,0xb6,},
                                        {0x91,0xcb,0x93,0xc7,0x87,0x96,0x4e,0x10,0xd9,0x52,0x7d,0x99,0x9c,0x6f,0x93,0x6b,},
                                        {0x49,0xb1,0x8b,0x42,0xf8,0xe8,0x36,0x7c,0xbe,0xb5,0xef,0x10,0x4b,0xa1,0xc7,0xcd,},
                                        {0x87,0x08,0x4b,0x3b,0xa7,0x00,0xba,0xde,0x95,0x56,0x10,0x67,0x27,0x45,0xb3,0x74,},
                                        {0xe7,0xa7,0xb9,0xe9,0xec,0x54,0x0d,0x5f,0xf4,0x3b,0xdb,0x12,0x79,0x2d,0x1b,0x35,},
                                        {0xc7,0x99,0xb5,0x96,0x73,0x8f,0x6b,0x01,0x8c,0x76,0xc7,0x4b,0x17,0x59,0xbd,0x90,},
                                        {0x7f,0xec,0x5b,0xfd,0x9f,0x9b,0x89,0xce,0x65,0x48,0x30,0x90,0x92,0xd7,0xe9,0x58,},
                                        {0x40,0xf2,0x50,0xb2,0x6d,0x1f,0x09,0x6a,0x4a,0xfd,0x4c,0x34,0x0a,0x58,0x88,0x15,},
                                        {0x3e,0x34,0x13,0x5c,0x79,0xdb,0x01,0x02,0x00,0x76,0x76,0x51,0xcf,0x26,0x30,0x73,},
                                        {0xf6,0x56,0xab,0xcc,0xf8,0x8d,0xd8,0x27,0x02,0x7b,0x2c,0xe9,0x17,0xd4,0x64,0xec,},
                                        {0x18,0xb6,0x25,0x03,0xbf,0xbc,0x07,0x7f,0xba,0xbb,0x98,0xf2,0x0d,0x98,0xab,0x34,},
                                        {0x8a,0xed,0x95,0xee,0x5b,0x0d,0xcb,0xfb,0xef,0x4e,0xb2,0x1d,0x3a,0x3f,0x52,0xf9,},
                                        {0x62,0x5a,0x1a,0xb0,0x0e,0xe3,0x9a,0x53,0x27,0x34,0x6b,0xdd,0xb0,0x1a,0x9c,0x18,},
};

const uint8_t key40BitMix[5] = {0xcd,0x56,0x94,0x81,0x7d};
const uint8_t result40BitMix[16][16] = {
                                        {0xcc,0xd9,0xd7,0xab,0xe9,0x33,0x73,0x1c,0xed,0xd0,0x6f,0x5a,0xc4,0xee,0x47,0xd0,},
                                        {0x9d,0x04,0x1f,0x30,0x6c,0x16,0x9d,0x55,0x11,0xf9,0x85,0x44,0x81,0xda,0x70,0x11,},
                                        {0x90,0x00,0x07,0x85,0xd7,0x8c,0x43,0x2d,0x4f,0xd7,0xfa,0x5c,0xca,0xda,0x9f,0xa7,},
                                        {0x76,0xb6,0x91,0x10,0x12,0x89,0xd0,0x83,0x72,0x60,0xc4,0xaa,0x89,0x18,0xfb,0xd3,},
                                        {0x30,0xe9,0x3e,0x42,0x53,0x92,0xf4,0xb7,0x07,0x16,0xc2,0xe6,0xc3,0xbe,0xff,0x2e,},
                                        {0x58,0x59,0x8a,0x50,0xe6,0x95,0xb6,0x5f,0x57,0xce,0x0b,0xdb,0x65,0x18,0xed,0x29,},
                                        {0xc1,0x37,0xa6,0x5e,0x82,0x2c,0x3c,0x18,0x15,0x81,0x1c,0xb4,0xee,0xaa,0xef,0xff,},
                                        {0x3c,0x65,0xc9,0x21,0x39,0x54,0x59,0x15,0x4e,0x63,0x94,0x18,0x51,0xf5,0xc8,0x90,},
                                        {0x36,0x87,0x59,0x42,0xa9,0x11,0xf1,0x3e,0x06,0x44,0xb9,0x60,0xe7,0x11,0x25,0x19,},
                                        {0x1b,0xfb,0x23,0xf5,0xd1,0xce,0x51,0x9f,0x83,0x72,0x43,0xb3,0xd8,0x89,0x88,0xa4,},
                                        {0xce,0x43,0x2a,0xe6,0xc6,0xf0,0x2c,0x3a,0x6f,0x77,0x5e,0x46,0x43,0xd8,0xaf,0xac,},
                                        {0x02,0xd4,0x54,0x53,0x98,0x01,0xa9,0x5c,0x0e,0x2f,0x99,0xad,0xa5,0xc6,0x15,0xdf,},
                                        {0x86,0xd9,0xe4,0x00,0x6c,0xe6,0x54,0xfe,0x83,0x47,0x67,0x89,0x71,0x67,0x7d,0x80,},
                                        {0xed,0xb6,0xc3,0xd8,0xab,0x7e,0x9d,0x41,0xe4,0xa9,0x52,0xf2,0x27,0xdd,0xb1,0x89,},
                                        {0x1e,0x95,0xd5,0x80,0x09,0xa7,0xf6,0x8e,0x2e,0xa7,0xf2,0x13,0x2e,0x91,0x31,0xe9,},
                                        {0x61,0x2d,0x5b,0x1e,0x29,0x55,0xbe,0x69,0x41,0x3d,0xc4,0xa0,0x5d,0x19,0xd1,0xb1,},
};

const uint8_t key56BitMix[7] = {0x1d,0xf7,0xcd,0x56,0x94,0x81,0x7d};
const uint8_t result56BitMix[16][16] = {
                                        {0x2d,0xde,0x3a,0x4c,0x40,0x9c,0x5a,0xbf,0xec,0x11,0xd2,0xf4,0x5f,0x85,0x44,0xce,},
                                        {0xee,0x48,0x3e,0xc3,0x87,0xb4,0xee,0xac,0xc0,0x83,0xd5,0x79,0xc6,0x0c,0x35,0x32,},
                                        {0xa9,0x2b,0xcb,0x37,0xdd,0xe8,0xc0,0x41,0xf2,0x41,0x39,0x23,0x2a,0xaf,0x1e,0x4d,},
                                        {0xe5,0x30,0xa1,0xce,0x54,0x2f,0xc4,0x87,0x50,0xd4,0xb9,0xb3,0xe2,0xb0,0x0e,0x69,},
                                        {0x2d,0x7e,0xb4,0x1d,0xf8,0x5e,0xe6,0x3c,0xf6,0x97,0x96,0xd1,0xf3,0x12,0x6a,0xcb,},
                                        {0x39,0x01,0x95,0xf1,0x2c,0xb4,0x91,0x77,0x27,0x10,0xc6,0x15,0xe6,0xef,0xd0,0xd8,},
                                        {0x0a,0x75,0x79,0x66,0x46,0x42,0xc1,0xaf,0xc4,0x44,0x5a,0xc6,0xe3,0xeb,0xf4,0x67,},
                                        {0x0f,0xaa,0x3c,0xae,0x4a,0x25,0x85,0xe2,0x23,0x32,0x80,0x82,0xb5,0x8b,0xaa,0x90,},
                                        {0xac,0xb9,0x1e,0x11,0xe8,0xe9,0xaf,0x45,0xda,0x57,0xde,0xc8,0x7d,0x6f,0x6e,0x2c,},
                                        {0x57,0xd4,0x65,0x57,0x7a,0x5c,0xa8,0x01,0x2b,0xa9,0x15,0x91,0xa8,0x6c,0xcc,0xda,},
                                        {0x01,0x31,0x6f,0x4e,0xfe,0xd6,0x5b,0x73,0x41,0xaa,0x87,0xd0,0x48,0xd4,0xbc,0x13,},
                                        {0x0e,0xa3,0x19,0xa9,0xf5,0x03,0x08,0x1e,0xbc,0x92,0xe3,0xb4,0xf4,0x95,0x10,0x35,},
                                        {0x4d,0xda,0x00,0x62,0x4f,0x58,0x8b,0xc6,0x24,0x19,0x3c,0xad,0x67,0xfd,0x08,0xb1,},
                                        {0x06,0x22,0x0a,0x5a,0x0d,0xcb,0xf5,0xcf,0x0c,0x2c,0x60,0x82,0x24,0x4b,0x61,0x64,},
                                        {0x27,0xc1,0x79,0xb7,0x8c,0x45,0x90,0x7e,0x2a,0x94,0x89,0xa8,0x23,0xab,0x77,0xbb,},
                                        {0x7a,0x78,0x24,0x69,0x05,0x87,0x88,0xe3,0x95,0x7c,0x4c,0x76,0x40,0x59,0xec,0x86,},
};

const uint8_t key64BitMix[8] = {0x90,0x1d,0xf7,0xcd,0x56,0x94,0x81,0x7d};
const uint8_t result64BitMix[16][16] = {
                                        {0x78,0x40,0x29,0xb6,0xd1,0xcf,0xbd,0x0d,0x10,0x78,0xa9,0xb1,0xcf,0x09,0x3e,0xd4,},
                                        {0x81,0xd0,0x25,0x4a,0xfd,0x1f,0x79,0x74,0xa0,0x1b,0x73,0x8b,0x36,0x5c,0x56,0x80,},
                                        {0x6b,0xb7,0x38,0x7c,0xdc,0xdd,0x0c,0x19,0x99,0x28,0xa5,0x76,0xde,0x9b,0xe6,0xe2,},
                                        {0x47,0x55,0xf3,0xb5,0x3b,0x01,0x5a,0x8c,0x58,0x53,0xc4,0x35,0x53,0xfe,0x94,0x95,},
                                        {0x90,0x5d,0x9c,0xc7,0xba,0x4a,0x1c,0xae,0xc5,0x99,0x59,0xfd,0x88,0x39,0x9c,0x57,},
                                        {0x16,0xa1,0xe5,0xa8,0xc9,0xd8,0x17,0xb0,0xa4,0xbd,0x73,0x27,0x83,0x7e,0x22,0xf6,},
                                        {0xf6,0x54,0x0c,0xdd,0xfb,0x46,0x16,0x08,0xb8,0x74,0xb9,0xf2,0x70,0x6c,0x20,0x9c,},
                                        {0x64,0x24,0xc8,0xe7,0x46,0x99,0xc9,0x16,0xe8,0x21,0x52,0x00,0xb0,0xe7,0xb7,0xc5,},
                                        {0x59,0xa2,0xa3,0x9a,0x5a,0x89,0x63,0x2d,0x45,0xdf,0xa2,0x8a,0x5d,0x87,0x6a,0x38,},
                                        {0x53,0x0b,0x2e,0xb7,0x2c,0x30,0x54,0x38,0x47,0xe3,0x61,0x10,0xfa,0x1d,0x1f,0x0a,},
                                        {0x37,0xae,0x3d,0x36,0x9d,0xda,0xd3,0xc5,0xc8,0x29,0xe1,0x32,0xbb,0xab,0x49,0xc0,},
                                        {0xf5,0xee,0x2a,0xb8,0x32,0x97,0xb7,0xa2,0x26,0x44,0xcd,0x82,0xaa,0x84,0x19,0xd6,},
                                        {0x3d,0x8b,0xbe,0x2e,0x3e,0x3e,0x89,0xf3,0x2a,0xc3,0x4a,0x24,0x63,0xc8,0x35,0x38,},
                                        {0x55,0x30,0x03,0x4a,0x55,0x12,0xc5,0x86,0x14,0x62,0x08,0x2b,0x66,0x26,0x60,0x19,},
                                        {0x04,0xe2,0x19,0x8b,0x00,0xc0,0x69,0x11,0xfb,0xec,0xff,0x6b,0xc8,0x44,0x92,0xb6,},
                                        {0xad,0x0f,0x25,0x51,0xb9,0x34,0xc4,0xe1,0x48,0x94,0x6c,0x40,0xd9,0x55,0xbc,0x6a,},
};

const uint8_t key80BitMix[10] = {0x5e,0x3d,0x90,0x1d,0xf7,0xcd,0x56,0x94,0x81,0x7d};
const uint8_t result80BitMix[16][16] = {
                                        {0x1f,0x02,0x89,0xf1,0x9b,0xdb,0x86,0x3d,0xf4,0x1f,0xd5,0x3d,0x63,0xbc,0xa3,0xbc,},
                                        {0x07,0x3e,0x63,0x28,0x14,0xf8,0x7d,0x92,0x12,0x90,0xe7,0x86,0x66,0x15,0xc1,0xc3,},
                                        {0xd8,0x8b,0x6a,0x78,0x21,0x18,0xb2,0x3f,0x33,0x20,0xa0,0xe2,0x11,0x7a,0x82,0x00,},
                                        {0x32,0x8b,0xf5,0xa9,0xce,0xe3,0xc1,0x46,0x9e,0xaf,0x11,0xa2,0xf7,0xb9,0x31,0xa9,},
                                        {0x72,0x94,0xd1,0xb7,0xfa,0xa8,0x7e,0x20,0x68,0x91,0x54,0x02,0x4e,0xa1,0x65,0x31,},
                                        {0x34,0x68,0x6d,0x2d,0x0a,0xa5,0x68,0x79,0xac,0xe3,0x06,0xa7,0x5c,0xfa,0xfd,0x80,},
                                        {0xe2,0xf0,0x87,0x69,0xc9,0x56,0xa9,0x58,0x99,0xf8,0x06,0xbf,0x36,0xe4,0xf5,0xea,},
                                        {0x79,0xdd,0xef,0xe5,0xcc,0x15,0xbf,0x7c,0x77,0x7f,0xa1,0xb9,0x14,0x45,0x1e,0x67,},
                                        {0xce,0xfd,0x05,0x26,0x5a,0x3f,0xa1,0x94,0xff,0xff,0xe6,0x4c,0x82,0x11,0x04,0xac,},
                                        {0xf3,0xc9,0x87,0x5a,0x1a,0x34,0x90,0x84,0x4d,0x80,0xeb,0x36,0x2f,0x0e,0x73,0xd7,},
                                        {0xa2,0xcb,0xce,0xcc,0xe3,0xbe,0xa9,0x00,0xc3,0x19,0x5e,0x7e,0x5b,0xce,0x3a,0x14,},
                                        {0x49,0x4b,0xe3,0x2e,0x92,0x01,0xc1,0xe6,0xea,0xb6,0x04,0x88,0xb6,0xe3,0xc3,0x10,},
                                        {0x4a,0xc7,0xd3,0xb0,0x7b,0xbc,0xb8,0x9a,0x6f,0x81,0x89,0x9f,0x9c,0x86,0xd3,0x73,},
                                        {0x44,0x84,0xb9,0x84,0x4e,0xad,0x68,0xe2,0x6a,0x3c,0xec,0xee,0xe6,0x24,0xe6,0xa9,},
                                        {0x54,0x68,0xb7,0x3f,0xbd,0xb7,0x5b,0x2f,0x02,0xc4,0x0a,0xcd,0x75,0xb0,0x6b,0x86,},
                                        {0x53,0xa1,0x56,0x54,0x2f,0xee,0x0f,0xba,0x45,0x41,0x05,0x48,0x9d,0x9f,0xcc,0x6e,},
};

const uint8_t key128BitMix[16] = {0x0b,0x3a,0x34,0xdf,0x2f,0x6f,0x5e,0x3d,0x90,0x1d,0xf7,0xcd,0x56,0x94,0x81,0x7d};
const uint8_t result128BitMix[16][16] = {
                                        {0xb9,0x9c,0x43,0x20,0x9c,0x4b,0xae,0x0b,0xc0,0x34,0xd4,0x98,0xac,0x44,0x92,0xe9,},
                                        {0xfa,0xcf,0xae,0xb7,0x62,0x50,0xd6,0x42,0x74,0xf4,0xa1,0xc3,0xaf,0x52,0x90,0xc6,},
                                        {0x23,0x2f,0xee,0x3d,0xca,0x44,0x3e,0x5e,0xa5,0xe6,0x99,0x2f,0xda,0x2f,0xe8,0xa2,},
                                        {0x8e,0x74,0xae,0x36,0x27,0x5c,0x91,0x02,0x6c,0x2d,0xe4,0xa0,0x17,0x53,0x62,0xfc,},
                                        {0x01,0xd6,0xa0,0xd2,0x3c,0xa1,0x74,0xbe,0x87,0x76,0x5a,0xe5,0xcf,0xfa,0xab,0x26,},
                                        {0x37,0x71,0x30,0x8b,0x5b,0x49,0x61,0x20,0x01,0xd7,0x0d,0x5e,0xfd,0xac,0xb4,0xff,},
                                        {0x90,0xec,0xd9,0x1f,0x30,0x41,0x96,0xfa,0x7d,0x81,0x76,0xb6,0x9b,0xdc,0x81,0x5f,},
                                        {0x96,0xf5,0xef,0x13,0x5a,0xd8,0x21,0xe5,0x18,0xe4,0x13,0x31,0xa7,0xae,0x9d,0x04,},
                                        {0xbe,0x38,0xcf,0xe0,0x1f,0xd3,0x19,0x20,0x7b,0xe9,0x35,0x9b,0xb8,0x64,0xab,0x7a,},
                                        {0x8b,0x6d,0x27,0x23,0x04,0x40,0x5f,0xcf,0x22,0x28,0x08,0x45,0xe9,0x04,0xbf,0x44,},
                                        {0x65,0x94,0xcb,0x38,0x8e,0x9c,0x5d,0x49,0xac,0x8e,0xbb,0xa9,0x7a,0xb6,0x2d,0x27,},
                                        {0x55,0xfb,0xee,0xb6,0xd1,0x39,0x60,0x09,0xa9,0x73,0xd2,0x03,0x00,0x63,0x96,0x68,},
                                        {0x8d,0x05,0x6a,0x32,0xd6,0xbf,0x28,0x34,0x6d,0x58,0xa8,0x22,0xbe,0x87,0x93,0xe0,},
                                        {0x6d,0x5c,0x26,0x36,0x82,0x27,0x55,0x78,0x0b,0xda,0x8f,0xba,0x35,0xd8,0xa3,0xbe,},
                                        {0xcc,0x2c,0x43,0x87,0xb2,0xd0,0xfd,0x31,0x60,0xd8,0x9d,0x75,0xf6,0x4f,0x30,0x97,},
                                        {0x98,0x7f,0x15,0xf6,0xe9,0x3f,0x0d,0xc1,0x11,0x5b,0x85,0xd5,0xd4,0x13,0x69,0xc1,},
};

const uint8_t key192BitMix[24] = {0xcc,0x80,0x0a,0x04,0x5e,0x19,0x39,0x26,0x0b,0x3a,0x34,0xdf,0x2f,0x6f,0x5e,0x3d,0x90,0x1d,0xf7,0xcd,0x56,0x94,0x81,0x7d};
const uint8_t result192BitMix[16][16] = {
                                        {0x3f,0x9f,0xda,0x77,0x95,0x46,0xb3,0x07,0x79,0x44,0xe8,0x04,0x3d,0xba,0xf8,0xe2,},
                                        {0x5d,0xba,0x2a,0xef,0xb1,0xda,0xb3,0x36,0x0a,0xf5,0x14,0x33,0x40,0xfb,0xed,0x86,},
                                        {0x54,0x0f,0xb6,0xe1,0x4f,0x8b,0x8f,0x9c,0x9f,0xa5,0x4c,0xda,0x54,0x28,0x50,0x59,},
                                        {0x40,0xaa,0xd3,0x02,0x7d,0xbd,0x5d,0xd8,0xaf,0x2e,0x43,0xbc,0xdb,0xa1,0xd0,0x87,},
                                        {0x11,0x93,0x3a,0x8c,0x82,0x0a,0x45,0x0e,0xff,0x0c,0xee,0xd9,0x9d,0x22,0x3d,0xcc,},
                                        {0x03,0x5c,0xbc,0x54,0xe7,0xca,0x2a,0x85,0x73,0x12,0xb9,0xc4,0xb5,0xc5,0x10,0x96,},
                                        {0x09,0xd9,0xa4,0x75,0xd2,0x27,0xe7,0x6f,0x47,0x22,0x52,0xe1,0x0c,0x7b,0xc8,0xb8,},
                                        {0x72,0x9d,0x42,0x5d,0xfd,0xee,0xbe,0x39,0x1f,0x81,0xad,0x76,0x37,0x83,0xe0,0x15,},
                                        {0xfe,0xe5,0x81,0x1f,0x2c,0x4a,0x5e,0x30,0xd2,0x65,0x30,0xca,0x62,0xf0,0xc3,0xc1,},
                                        {0x24,0xdc,0x2a,0xf9,0xd7,0x7c,0xc1,0x94,0x1a,0x9d,0x69,0xad,0x77,0x06,0x1c,0x4d,},
                                        {0xd6,0xba,0xbe,0x8e,0x00,0xb6,0xe3,0xc6,0x90,0x3e,0x9f,0x5d,0x19,0xd0,0x6a,0xa8,},
                                        {0xcc,0xac,0x74,0x55,0x50,0xbf,0xba,0xb5,0xce,0x37,0xaa,0x21,0x96,0x66,0xd5,0x42,},
                                        {0xcc,0xa6,0x8e,0xe0,0xb9,0x31,0x61,0x64,0x16,0xdd,0x17,0xe7,0x5b,0xd4,0x49,0x33,},
                                        {0xc1,0x48,0x70,0xa1,0x3e,0xb6,0x16,0x10,0xe6,0xcd,0x31,0xb2,0x7b,0xb9,0x85,0x28,},
                                        {0x54,0x0e,0xe8,0x79,0xa1,0x3d,0xf7,0xf3,0x81,0xf1,0x1e,0x2b,0x15,0x39,0x74,0xaf,},
                                        {0xf6,0x04,0xd2,0x2e,0x99,0x3e,0xa1,0x19,0x76,0x20,0xc5,0x0f,0x2d,0x0d,0xc0,0xc3,},
};

const uint8_t key256BitMix[32] = {0x44,0x9c,0x0c,0x95,0x95,0xaa,0xdf,0xf9,0xcc,0x80,0x0a,0x04,0x5e,0x19,0x39,0x26,0x0b,0x3a,0x34,0xdf,0x2f,0x6f,0x5e,0x3d,0x90,0x1d,0xf7,0xcd,0x56,0x94,0x81,0x7d};
const uint8_t result256BitMix[16][16] = {
                                        {0xb4,0x8d,0xf6,0x33,0x9c,0xae,0x1b,0x47,0x22,0x9b,0x58,0x05,0xf4,0xd9,0xeb,0x51,},
                                        {0x8a,0x81,0x90,0x35,0xe1,0x0a,0x1a,0x08,0x68,0xde,0x17,0xb9,0x0d,0x7c,0x40,0x04,},
                                        {0x31,0xaf,0xdb,0xef,0x3f,0xbf,0x1c,0x23,0x61,0x1d,0x5b,0x49,0xad,0xb7,0x97,0xfa,},
                                        {0x0d,0x20,0xff,0x85,0xd0,0xe4,0xd1,0xa3,0x86,0xe5,0x32,0xb6,0xf6,0xce,0x81,0xa7,},
                                        {0x79,0x4b,0x4f,0x4e,0x53,0xe6,0xe5,0x31,0x48,0x9c,0x27,0x6e,0x74,0xae,0x54,0x7f,},
                                        {0x2d,0xeb,0x0d,0x2d,0x56,0xf6,0x63,0x60,0xa2,0x90,0xc6,0x42,0x39,0xcc,0x5c,0x3b,},
                                        {0x19,0x4e,0x75,0x75,0x17,0xd6,0xbd,0x95,0x78,0x61,0x4c,0x84,0x5d,0xdb,0x1c,0x85,},
                                        {0x57,0xdf,0x30,0x1e,0x00,0x38,0x65,0x64,0x38,0xfd,0x1c,0x9a,0xbd,0xde,0x89,0xb4,},
                                        {0x3e,0x51,0x46,0x94,0x23,0x23,0x92,0x70,0x39,0x95,0x1e,0x4a,0xc5,0x24,0x91,0xe1,},
                                        {0x8d,0x9d,0x62,0xd4,0xb3,0x3e,0x8b,0xed,0xa3,0x21,0xef,0x18,0x6e,0x3a,0x6b,0x48,},
                                        {0x57,0xca,0x8c,0xba,0x3c,0x86,0x65,0x0f,0x51,0x4f,0x61,0xeb,0xde,0x52,0x4d,0x88,},
                                        {0x55,0xe8,0xef,0x35,0x80,0x1c,0x40,0x44,0x5a,0x2c,0x86,0xca,0x2d,0x60,0xef,0x64,},
                                        {0xf3,0x85,0x92,0x63,0xd5,0x5c,0xd5,0x89,0xc6,0xf5,0x39,0xc7,0x20,0xa1,0xf4,0x82,},
                                        {0xb0,0x87,0xe3,0x4f,0xb1,0x1c,0x76,0x50,0x95,0xa4,0x2b,0x18,0x7d,0x04,0x54,0x36,},
                                        {0xc0,0x05,0x35,0xae,0x8e,0x71,0x2b,0x67,0xc5,0x70,0xaf,0xe3,0xaf,0x35,0xd1,0xb5,},
                                        {0x57,0xc2,0x0a,0x08,0x5e,0x04,0xc1,0x6f,0x8e,0x51,0xd0,0x0c,0xb5,0xde,0x0b,0x2c,},
};

/*******************************************************************************************************/
/* Declare arrays of our test vectors so we can use a simple loop to encrypt/decrypt all of them       */
/*******************************************************************************************************/

// Key array
uint8_t * keys[14] =
{
    (uint8_t *)key40BitInc,
    (uint8_t *)key56BitInc,
    (uint8_t *)key64BitInc,
    (uint8_t *)key80BitInc,
    (uint8_t *)key128BitInc,
    (uint8_t *)key192BitInc,
    (uint8_t *)key256BitInc,
    (uint8_t *)key40BitMix,
    (uint8_t *)key56BitMix,
    (uint8_t *)key64BitMix,
    (uint8_t *)key80BitMix,
    (uint8_t *)key128BitMix,
    (uint8_t *)key192BitMix,
    (uint8_t *)key256BitMix,
};

// Result array
uint8_t * results[14] =
{
    (uint8_t *)result40BitInc,
    (uint8_t *)result56BitInc,
    (uint8_t *)result64BitInc,
    (uint8_t *)result80BitInc,
    (uint8_t *)result128BitInc,
    (uint8_t *)result192BitInc,
    (uint8_t *)result256BitInc,
    (uint8_t *)result40BitMix,
    (uint8_t *)result56BitMix,
    (uint8_t *)result64BitMix,
    (uint8_t *)result80BitMix,
    (uint8_t *)result128BitMix,
    (uint8_t *)result192BitMix,
    (uint8_t *)result256BitMix,
};

// Array of key lengths
uint16_t keyLengths[14] = {5,7,8,10,16,24,32,5,7,8,10,16,24,32};
// Array of offsets to check.  This demo will check the results of encrypting a string of zeros at certain offsets.
uint16_t offsets[16] = {0,16,240,256,496,512,752,768,1008,1024,1520,1536,2032,2048,3056,3072};

// A buffer to hold the data being encrypted/decrypted and the result
uint8_t buffer[16];

// An ARCFOUR context
ARCFOUR_SW_CONTEXT context;
// Buffer to contain the sBox used for the encryption
uint8_t sBox[256];


// Main function.  The first part of this function will encrypt and decrypt a simple string.
// THe second part of this function will encrypt strings of zeros using different key lengths.
// Sixteen-byte segments of the ciphertext will be checked against known results at 
// certain offsets to verify that they are correct.
int main (void)
{
    uint8_t keyIndex;                                 // Index tracking which key is being used for encryption
    uint16_t offsetIndex;                             // Index tracking which offset is being checked.
    uint16_t offset;                                  // Current offset in the encryption.
    uint8_t count = sizeof(keys)/sizeof(*keys);       // Number of keys to check

    // Test out the encryption/decryption functionality.  

    // Create an S-Box for use when encrypting our message.  This S-Box will be referenced from the ARCFOUR_SW_CONTEXT
    // 'context.'  The actual buffer used to contain the S-Box is 'sBox.'  We are using the 5-byte (40-bit) key 
    // 'key40BitInc' to create the S-Box.
    ARCFOUR_SW_CreateSBox (&context, sBox, (uint8_t *)key40BitInc, 5);

    // Populate our data buffer with some dummy data
    for (offset = 0; offset < 16; offset++)
    {
        buffer[offset] = offset;
    }
    
    // Encrypt our dummy data using the S-Box in our initialized context
    ARCFOUR_SW_Encrypt (buffer, 16, &context);
    
    // Re-initialize the context with the same key.  ARCFOUR is a symmetric key cipher, so the decrypt 
    // process is exactly the same as the encrypt process.
    ARCFOUR_SW_CreateSBox (&context, sBox, (uint8_t *)key40BitInc, 5);

    // Decrypt our message.  Note that the ARCFOUR_SW_Decrypt function is identical to the ARCFOUR_SW_Encrypt function.
    ARCFOUR_SW_Decrypt (buffer, 16, &context);
    
    // Verify our decryption results against the known dummy data
    for (offset = 0; offset < 16; offset++)
    {
        if (buffer[offset] != offset)
            while(1);
    }
    
    
    
    
    // Check encryption using several keys to verify that the results are correct.
    for (keyIndex = 0; keyIndex < count; keyIndex++)
    {
        // ARCFOUR S-box initialization function.  Creates a new S-Box associated with the ARCFOUR_SW_CONTEXT context using
        // the specified key from the 'key' array, which has a length specified in the 'keyLengths' array.
        ARCFOUR_SW_CreateSBox(&context,sBox,keys[keyIndex],keyLengths[keyIndex]);

        offset = 0;

        // Encrypt the plaintext until we check the ciphertext at 16 offsets.
        for (offsetIndex = 0; offsetIndex < 16; offsetIndex++)
        {
            // Encrypt 16-byte segments of zeros until we get to one of the pre-chosen offsets.
            while (offset != offsets[offsetIndex])
            {
                // Reset the buffer to zero.
                memset(buffer,0x00,16);
                // Encrypt the buffer
                ARCFOUR_SW_Encrypt(buffer,16,&context);
                offset += 16;
            }
            // Calculate the ciphertext at the offset we want to check
            memset(buffer,0x00,16);
            ARCFOUR_SW_Encrypt(buffer,16,&context);
            offset += 16;

            // Compare the ciphertext at the offset to the known ciphertext in the results array
            if (memcmp (results[keyIndex] + (16 * offsetIndex),buffer,16))
                while(1);
        }        
    }

    while(1);
}











